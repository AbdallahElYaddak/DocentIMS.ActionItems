<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="DocentIMS.ActionItems"
      metal:use-macro="context/main_template/macros/master">




  <body>
        <metal:content-core fill-slot="content-core" tal:define="todag view/today">
          <div>
              <!--table class="pat-xdatatables pat-tablesorter stacktable listing table-responsive" data-pat-datatables="pageLength: 50; pagingType: simple"-->
            <table class="listing pat-datatables listing" data-pat-datatables="pageLength: 50">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Title</th>
                  <th>Creator</th>
                  <th>Assigned to</th>
                  <th>Initial Due</th>
                  <th>Revised Due</th>
                  <th>Priority</th>
                  <th>Items related (TO DO)</th>
                  <th>Closed</th>
                  <th>Days Left</th>
                </tr>
              </thead>
              <tbody>
                <tr tal:repeat="item context/results|context/getFolderContents">
                  <tal:obj tal:define="obj item/getObject">
                    <td>${item/actionno|None}</td>
                    <td><a href="${item/getURL}">${item/Title}</a></td>
                    <td><span>${item/Creator/title|None}</span></td>
                    <td><span>${item/assigned_to/title|None}</span></td>
                    <td><span>${item/initial_due_date|None}</span></td>
                    <td><span>${item/revised_due_date|None}</span></td>
                    <td class="priority-${item/priority|None} ">
                      <span class="pri-box flex">
                        <span id="traffic-light" tal:condition="item/priority|None">
                          <span id="tl-1" class="active-${python: item.priority==1 }" />
                          <span id="tl-2" class="active-${python: item.priority==2 }"  />
                          <span id="tl-3" class="active-${python: item.priority==3 }" />
                        </span>
                        <span>${item/priority|None}</span>
                      </span>
                    </td>



                    <td tal:define="related obj/related_item|None">
                     <span tal:condition="related">${related/to_object/title|None}</span>

                    </td>
                    <td>
                      <span tal:condition="obj/is_this_item_closed|None">Yes</span>
                      <span tal:condition="not: obj/is_this_item_closed|None">No</span>
                  </td>
                  <td>
                    <tal:check  tal:condition="item/duedate|None">
                      <span tal:define="left python:item.duedate - todag; days python: left.days"
                        class="previousdue-${python: days<0} late14-${python: days<14} soon14-${python: days>14} later-${python: days>=28}">${left/days|None}</span>
                    </tal:check>
                  </td>
                  </tal:obj>
                </tr>
              </tbody>
              <table>
            </div>
            <style>
              .pri-box.flex {display: flex}
               .priority-1 span { color: red; padding: 1px 5px}
              .priority-2 span { color: orange; padding: 1px 5px}
              .priority-3 span  {color:  green; padding: 1px 5px}
              span.previousdue-True { color: silver;}
              #traffic-light {background:#444; border-radius: 3px; display: flex; flex-direction: column; justify-content: space-around; align-items: center; width: 17px; height: 35px;  }
              #traffic-light > span {border-radius: 50%; width: 6px ; height: 6px  ; padding: 0; display: block; opacity: 0.33}
              #tl-1 {background: #FF0000}
              #tl-2 {background: #FFFF00}
              #tl-3 {background: #00FF00}
              #traffic-light .active-True {opacity: 1 !important; width: 10px; height: 10px}
              .late14-True {color: red}
              span.late14-True {color #FF0000  !important}
              .soon14-True {color: orange}
              span.later-True {color: green}
            </style>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>


        </metal:content-core>
</body>
</html>
